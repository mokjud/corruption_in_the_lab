---
title: "Corruption in the lab"
author: "Fedor Anna, Mokos Judit"
date: "19/12/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE) # global options
library(rmarkdown)
```
# Description of the experiment
    
Sequential dyadic die-rolling task  

Two-by-two design:
    
* Game: simple game or charity game
* Partner: simulated honest partner or simulated dishonest partner  

Participants are randomly assigned to one of the four conditions:

* SH: simple game with honest partner
* SD: simple game with dishonest partner
* CH: charity game with honest partner
* CD: charity game with dishonest partner  

Each participant plays 20 rounds of the game. A round of game consists of the following steps:

1. Participant learns the reported number of the supposed partner
2. Participant throws a dice
3. Participant reports the number 
4. Both players get paid according to the reported numbers
5. In the charity game a charity foundation gets a small amount of donation  

# Dummy data

Data frame column names (each row is a dice roll):

* ID: random ID of participant
* Game: simple or charity (S/C)
* Partner: honest or dishonest (H/D)
* Index: index of round of game
* ValueA: value of simulated dice roll
* ValueB: value of participant's reported dice roll
* Q1: answer to first questionnaire quiestion
* Q2: answer to second questionnaire question
* Fingerratio: ratio of two fingers
* Saliva: NO IDEA  

```{r generate dummy data}

N = 10 # number of participants in the dummy data

IDs <- sample(10000:19999, N)
games <- sample(c("S", "C"), N, replace=TRUE)
partners <- sample(c("H", "D"), 10, replace=TRUE)
A_honest <- sample(1:6, 20, replace=TRUE)
A_dishonest <- sample(4:6, 20, replace=TRUE)
fingerratios <- rnorm(N, mean = 1, sd = 0.1)
salivas <- rnorm(N, mean = 3, sd = 1)

ValueAs <- vector("integer", N*20)
for (i in 1:N) {
  if (partners[i] == "H") {ValueAs[((i-1)*20+1) : ((i-1)*20+20)] <- A_honest}
  if (partners[i] == "D") {ValueAs[((i-1)*20+1) : ((i-1)*20+20)] <- A_dishonest}
}

rawdata <- data.frame("ID" = rep(IDs, times = 1, length.out = NA, each = 20), 
                      "Game" = rep(games, times = 1, length.out = NA, each = 20), 
                      "Partner" = rep(partners, times = 1, length.out = NA, each = 20), 
                      "Index" = rep(1:20, N), 
                      "ValueA" = ValueAs, 
                      "ValueB" = sample(1:6, N*20, replace = TRUE), 
                      "Q1" = sample(letters, N*20, replace = TRUE), 
                      "Q2" = sample(letters, N*20, replace = TRUE),
                      "Fingerratio" = rep(fingerratios, times = 1, length.out = NA, each = 20),
                      "Saliva" = rep(salivas, times = 1, length.out = NA, each = 20))

```
# Figures

## Scatter plots of individual behavior
These should be based on Weisel & Shalvi, 2015, Fig. S10.
One plot per participant. Plots from the same condition should be compiled into one composite figure.
```{r}

```

## Heat map to demonstrate the distribution of reported numbers 
Like Weisel & Shalvi, 2015, Fig. 2, but instead of circles, each rectangle should be color coded according the number of observations within them.
One figure per condition.
```{r}

```

## Box plots of the mean number of doubles
One box for each condition on the same figure
```{r}

```

## Box plots of the mean reports: NINCS ÉRTELME
One box for each condition on the same figure
```{r}

```

# Statistics

## Distribution of reported numbers 
Kolmogorov-Smirnov
One per condition

## The number of doubles
Each participant ("dyad"") is a single observation: the number of reported doubles
Wilcoxon signed-rank U test
Expected value: 3.33 doubles/20 trials (16.7%; 20*1/6)
Separately for each condition
```{r}

```

## Mean reports: VAN ENNEK ÉRTELME NÁLUNK? NINCS
Each participant ("dyad"") is a single observation: the mean of the reported numbers
Wilcoxon signed-rank U test
Expected value: 3.5
Separately for each condition
```{r}

```
## Compare the number of doubles in pairs of conditions
Mann-Whitney U test
```{r}

```

## Effect size
To estimate the effect size of the honest-dishonest treatment let's compare the choices of participant Bs, who were paired with an honest A vs. a chaeting A
Data: from the supplementary material of Weisel&Shalvy, 2015 and from Wouda et al., 2015
```{r}

```

## Linear regression to test the effect of predictors
Dependent variable: number of reported doubles (interval)
Predictors: game (binary), partner (binary), finger length (interval), hormone levels (interval)

## random or non-random, khi square


## LM? 